\chapter{Tables}
Tables are big business in \LaTeX.  I use these packages to help me.

\begin{verbatim}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{dcolumn}
\end{verbatim}

Here's an example table

\begin{table}[!hb]
 \centering
	 \begin{tabular}{@{}rccc@{~}r@{.}l*3{r@{.}l@{~}r@{.}l}D{.}{\cdot}{2,1}}
	\toprule
	\multicolumn{1}{c}{Fibre Type}
	& N
	& M
	&\multicolumn{3}{c}{$L_t$ (nm)}
	&\multicolumn{4}{c}{$R_t$ (nm)}
	&\multicolumn{4}{c}{$d_t$ (nm)}
	&\multicolumn{4}{c}{${\Delta}Z_t$ (nm)}
	&\multicolumn{1}{c}{~}\\
\cmidrule(lr){1-1}
\cmidrule(lr){2-2}
\cmidrule(lr){3-3}
\cmidrule(lr){4-6}
\cmidrule(lr){7-10}
\cmidrule(lr){11-14}
\cmidrule(lr){15-18}
  SS Twisted & 5 & 4 & 313 &\multicolumn{2}{c}{(122)} & 5&7 &(1&6)  & 5&4 &(1&0)  &  150&5 &(63&1) &\multicolumn{1}{c}{~} \\
  \multicolumn{19}{c}{~}\\
  %\cmidrule(lr){3-18}
  &
  &
 	&\multicolumn{3}{c}{$L_s$ (nm)}
 	&\multicolumn{4}{c}{$R_s$ (nm)}
 	&\multicolumn{4}{c}{$W_s$ (nm)}
 	&\multicolumn{4}{c}{${\Delta}Z_s$ (nm)}
 	&\multicolumn{1}{c}{${\Delta}Z_{e}$ (nm)}\\
\cmidrule(lr){4-6}
\cmidrule(lr){7-10}
\cmidrule(lr){11-14}
\cmidrule(lr){15-18}
\cmidrule(lr){19-19}
  SS Spiral& 32 & 7 &123&(31&6)&11&4&(3&3)&11&1&(2&6)&32&9&(22&2)&26.9\\
  SSB Spiral& 64&18 &106&(22&9)&10&8&(2&7)&9&8&(1&8)&28&2&(8&1)&22.7\\
	%\midrule
  BSS Spiral&37 &19 &110&(44&9)&13&4&(3&0)&12&9&(1&8)&27&1&(9&1)&21.5\\
	%\midrule
  SSSB Spiral&26& 6 &104&(23&9)&13&3&(2&6)&16&4&(3&4)&29&9&(11&1)&22.5\\
	\bottomrule
	\end{tabular}	
	\caption[Basic Fibre Dimensions by TEM]{A funky table from Chirs Forman's thesis.}
	\label{tab:BasicXSBFibreDimensionsTEM}
\end{table}

\pagebreak
Here's what the code looks like (just for illustration!):
\begin{verbatim}
\begin{table}[!hb]
 \centering
	 \begin{tabular}{@{}rccc@{~}r@{.}l*3{r@{.}l@{~}r@{.}l}D{.}{\cdot}{2,1}}
	\toprule
	\multicolumn{1}{c}{Fibre Type}
	& N
	& M
	&\multicolumn{3}{c}{$L_t$ (nm)}
	&\multicolumn{4}{c}{$R_t$ (nm)}
	&\multicolumn{4}{c}{$d_t$ (nm)}
	&\multicolumn{4}{c}{${\Delta}Z_t$ (nm)}
	&\multicolumn{1}{c}{~}\\
\cmidrule(lr){1-1}
\cmidrule(lr){2-2}
\cmidrule(lr){3-3}
\cmidrule(lr){4-6}
\cmidrule(lr){7-10}
\cmidrule(lr){11-14}
\cmidrule(lr){15-18}
  SS Twisted & 5 & 4 & 313 &\multicolumn{2}{c}{(122)} & 5&7 &(1&6)  & 5&4 &(1&0)  &  150&5 &(63&1) &\multicolumn{1}{c}{~} \\
  \multicolumn{19}{c}{~}\\
  %\cmidrule(lr){3-18}
  &
  &
 	&\multicolumn{3}{c}{$L_s$ (nm)}
 	&\multicolumn{4}{c}{$R_s$ (nm)}
 	&\multicolumn{4}{c}{$W_s$ (nm)}
 	&\multicolumn{4}{c}{${\Delta}Z_s$ (nm)}
 	&\multicolumn{1}{c}{${\Delta}Z_{e}$ (nm)}\\
\cmidrule(lr){4-6}
\cmidrule(lr){7-10}
\cmidrule(lr){11-14}
\cmidrule(lr){15-18}
\cmidrule(lr){19-19}
  SS Spiral& 32 & 7 &123&(31&6)&11&4&(3&3)&11&1&(2&6)&32&9&(22&2)&26.9\\
  SSB Spiral& 64&18 &106&(22&9)&10&8&(2&7)&9&8&(1&8)&28&2&(8&1)&22.7\\
	%\midrule
  BSS Spiral&37 &19 &110&(44&9)&13&4&(3&0)&12&9&(1&8)&27&1&(9&1)&21.5\\
	%\midrule
  SSSB Spiral&26& 6 &104&(23&9)&13&3&(2&6)&16&4&(3&4)&29&9&(11&1)&22.5\\
	\bottomrule
	\end{tabular}	
	\caption[Basic Fibre Dimensions by TEM]{A funky table from my thesis.}
	\label{tab:BasicXSBFibreDimensionsTEM}
\end{table}
\end{verbatim}

\pagebreak

\section{Tables Made Easy}
Here is a simple table followed by the code that produced it.

\begin{center}
\begin{tabular}{lcr}
anchovy & banana & carrot \\
dog & apple & fennel \\
goat & strawberry & potato
\end{tabular}

\vspace*{2ex}

\begin{verbatim}
\begin{tabular}{lcr}
anchovy & banana & carrot \\
dog & apple & fennel \\
goat & strawberry & potato
\end{tabular}
\end{verbatim}
\end{center}

\vspace*{2ex}

The tabular environment is a special case of the ``array'' environment for distributing content uniformly across a region of the page.  This ability has already been exploited to align mathematical equations. For now though look at the first line.

\vspace*{2ex}

\begin{verbatim}
\begin{tabular}{lcr}
\end{verbatim}

\vspace*{2ex}

This command tells \LaTeX\ to enter the tabular environment. The letters l, c and r in the curly braces tell \LaTeX\ to create a table with three columns in which the first column is left justified, the second column is centered and the third column is right justified. Lets add a fourth column and this time center justify all the columns.

\begin{center}
\begin{tabular}{cccc}
anchovy & banana & carrot & Johnny\\
dog & apple & fennel & Pete\\
goat & strawberry & potato &
\end{tabular}

\vspace*{2ex}

\begin{verbatim}
\begin{tabular}{cccc}
anchovy & banana & carrot & Johnny\\
dog & apple & fennel & Pete\\
goat & strawberry & potato &
\end{tabular}
\end{verbatim}
\end{center}

\vspace*{2ex}

Each row in the table is a list of items separated by the {\&} symbol. The end of each row is denoted by \textbackslash\textbackslash. The last row in the table doesn't have a \textbackslash\textbackslash. You do not have to have data between the ampersands but you must have the right number of ampersands to match the number of columns that \LaTeX\ is expecting.

\subsection{Adding Borders To Tables}
\label{sec:vertLines}
Tables should never have vertical lines. No professionally typeset table contains vertical lines. Do not put vertical lines in your tables. That said, it is easy to do.

\begin{center}
\begin{tabular}{|c|c|c|c|}
anchovy & banana & carrot & Johnny\\
dog & apple & fennel & Pete\\
goat & strawberry & potato &
\end{tabular}

\vspace*{2ex}

\begin{verbatim}
\begin{tabular}{|c|c|c|c|}
anchovy & banana & carrot & Johnny\\
dog & apple & fennel & Pete\\
goat & strawberry & potato &
\end{tabular}
\end{verbatim}
\end{center}

\vspace*{2ex}

Tables should have neatly headed columns with the heading for each field separated from the data by horizontal lines. The {\textbackslash}toprule, {\textbackslash}cmidrule{} and {\textbackslash}bottomrule commands from the booktabs package are useful for controlling horizontal lines.

\begin{center}
\begin{tabular}{cccc}
\toprule
Ingredient 1 & Ingredient 2 & Ingredient 3 & Source \\
\cmidrule(){1-4}
anchovy & banana & carrot & Johnny\\
dog & apple & fennel & Pete\\
goat & strawberry & potato & \\
\bottomrule
\end{tabular}

\vspace*{2ex}

\begin{verbatim}
\begin{tabular}{cccc}
\toprule
Ingredient 1 & Ingredient 2 & Ingredient 3 & Source \\
\cmidrule(){1-4}
anchovy & banana & carrot & Johnny\\
dog & apple & fennel & Pete\\
goat & strawberry & potato & \\
\bottomrule
\end{tabular}
\end{verbatim}
\end{center}

Note that when using the {\textbackslash}bottomrule command you must add the \textbackslash\textbackslash ~symbol to the last line of data.  The last line of the table is now buried within the {\textbackslash}bottomrule command.

\pagebreak
\subsection{The {\textbackslash}cmidrule Command}
This useful and versatile command takes a bunch of options to control subtleties, like only putting lines across some of the columns, or not quite making them cross the full width of the column. The (lr) option trims the left and right ends of the lines off. For example:

\begin{center}
\begin{tabular}{ccccc}
\toprule
Recipe Version & Ingredient 1 & Ingredient 2 & Ingredient 3 & Source \\
\cmidrule(lr){1-1}
\cmidrule(l){2-2}
\cmidrule(){3-3}
\cmidrule(r){4-4}
\cmidrule(lr){5-5}
10.1 & anchovy & banana & carrot & Johnny\\
1.34 & dog & apple & fennel & Pete\\
709.23 & goat & strawberry & potato & \\
\bottomrule
\end{tabular}

\vspace*{2ex}

\begin{verbatim}
\begin{tabular}{ccccc}
\toprule
Recipe Version & Ingredient 1 & Ingredient 2 & Ingredient 3 & Source \\
\cmidrule(lr){1-1}
\cmidrule(l){2-2}
\cmidrule(){3-3}
\cmidrule(r){4-4}
\cmidrule(lr){5-5}
10.1 & anchovy & banana & carrot & Johnny\\
1.34 & dog & apple & fennel & Pete\\
709.23 & goat & strawberry & potato & \\
\bottomrule
\end{tabular}
\end{verbatim}
\end{center}

\pagebreak
\subsection{Aligning Decimal Points}
Note that the decimal points don't line up in the new column ``Recipe Version'' in the previous section. There is a way round this with the DColumn package.

\begin{center}
\begin{tabular}{D{.}{\cdot}{4,4}cccc}
\toprule
Recipe Version & Ingredient 1 & Ingredient 2 & Ingredient 3 & Source \\
\cmidrule(lr){1-1}
\cmidrule(lr){2-2}
\cmidrule(lr){3-3}
\cmidrule(lr){4-4}
\cmidrule(lr){5-5}
10.1 & anchovy & banana & carrot & Johnny\\
1.34 & dog & apple & fennel & Pete\\
709.23 & goat & strawberry & potato & \\
\bottomrule
\end{tabular}

\vspace*{2ex}

\begin{verbatim}
\begin{tabular}{D{.}{\cdot}{4,4}cccc}
\toprule
Recipe Version & Ingredient 1 & Ingredient 2 & Ingredient 3 & Source \\
\cmidrule(lr){1-2}
\cmidrule(lr){3-3}
\cmidrule(lr){4-4}
\cmidrule(lr){5-5}
\cmidrule(lr){6-6}
10.1 & anchovy & banana & carrot & Johnny\\
1.34 & dog & apple & fennel & Pete\\
709.23 & goat & strawberry & potato & \\
\bottomrule
\end{tabular}
\end{verbatim}
\end{center}

The DColumn package defines a new type of column, which can be invoked by placing a capital D in the {\textbackslash}tabular command defining the table. If defined using a D, then the column is placed in maths mode. D takes four parameters: D\{a\}\{b\}\{c,d\} where a is the symbol which is to be aligned, b is the symbol with which to replace the aligning character, and {c,d} must be integers which indicate \LaTeX\ should have up to c white space characters before the aligning character and d afterwards, thereby defining the position of the number within the column. The command {\textbackslash}cdot prints a special type of maths mode symbol, which is a dot that is vertically shifted and larger than a normal period, e.g.: $\cdot$

\pagebreak
\subsection{Final Table Trick}
DColumn forces the column to be in maths mode which is why the heading ``Recipe Version'' was typeset in italics in the previous section. Indeed \LaTeX\ tried to interpret the heading of the table as a number to be aligned.  We can over ride this behaviour by using the {\textbackslash}multicolumn command to locally impose a different type of justification and temporarily disable the maths mode as follows:

\begin{center}
\begin{tabular}{D{.}{\cdot}{4,4}cccc}
\toprule
\multicolumn{1}{c}{Recipe Version}& Ingredient 1 & Ingredient 2 & Ingredient 3 & Source \\
\cmidrule(lr){1-1}
\cmidrule(lr){2-2}
\cmidrule(lr){3-3}
\cmidrule(lr){4-4}
\cmidrule(lr){5-5}
10.1 & anchovy & banana & carrot & Johnny\\
1.34 & dog & apple & fennel & Pete\\
709.23 & goat & strawberry & potato & \\
\bottomrule
\end{tabular}

\vspace*{2ex}

\begin{verbatim}
\begin{tabular}{D{.}{\cdot}{4,4}cccc}
\toprule
\multicolumn{1}{c}{Recipe Version} & Ingredient 1 & Ingredient 2 & Ingredient 3 & Source \\
\cmidrule(lr){1-1}
\cmidrule(lr){2-2}
\cmidrule(lr){3-3}
\cmidrule(lr){4-4}
\cmidrule(lr){5-5}
10.1 & anchovy & banana & carrot & Johnny\\
1.34 & dog & apple & fennel & Pete\\
709.23 & goat & strawberry & potato & \\
\bottomrule
\end{tabular}
\end{verbatim}
\end{center}

This introduces you to the multicolumn command which you can use to span text over several columns.  The format is \textbackslash{multicolumn}\{n\}\{j\}\{text\} where n is the number of columns to span. j is the justification: either l,c or r; and text is the text to add. There is also a similar command \textbackslash{multirow}.

\pagebreak
\section{Numbering Tables}
To tell \LaTeX\ to assign a number to a table and add it to the list of tables you must use the {\textbackslash}begin\{table\} command to tell \LaTeX\ to create a table environment, e.g.:

\begin{table}[!h]
\centering
\begin{tabular}{D{.}{\cdot}{4,4}cccc}
\toprule
\multicolumn{1}{c}{Recipe Version}& Ingredient 1 & Ingredient 2 & Ingredient 3 & Source \\
\cmidrule(lr){1-1}
\cmidrule(lr){2-2}
\cmidrule(lr){3-3}
\cmidrule(lr){4-4}
\cmidrule(lr){5-5}
10.1 & anchovy & banana & carrot & Johnny\\
1.34 & dog & apple & fennel & Pete\\
709.23 & goat & strawberry & potato & \\
\bottomrule
\end{tabular}
\caption[Table of Banned Recipes]{Recipes that ought to be banned.}
\label{tab:Recipes}
\end{table}
\begin{verbatim}
\begin{table}[!h]
\centering
\begin{tabular}{D{.}{\cdot}{4,4}cccc}
\toprule
\multicolumn{1}{c}{Recipe Version}& Ingredient 1 & Ingredient 2 & Ingredient 3 & Source \\
\cmidrule(lr){1-1}
\cmidrule(lr){2-2}
\cmidrule(lr){3-3}
\cmidrule(lr){4-4}
\cmidrule(lr){5-5}
10.1 & anchovy & banana & carrot & Johnny\\
1.34 & dog & apple & fennel & Pete\\
709.23 & goat & strawberry & potato & \\
\bottomrule
\end{tabular}
\caption[Table of Banned Recipes]{Recipes that ought to be banned.}
\label{tab:Recipes}
\end{table}
\end{verbatim}

In the table environment the {\textbackslash}caption[text1]\{text2\} command adds a caption, where text1 appears in the list of tables at the beginning of the document and text2 is the local caption.  The label command creates a label with which to reference the table e.g. Table \ref{tab:Recipes} is a table of recipes that have been made up to illustrate how to use tables in \LaTeX. We also use the {\textbackslash}centering command to center the table and caption within the table environment. We could also use the {\textbackslash}begin\{center\} and {\textbackslash}end\{center\} commands. Finally, the [!h] option in the {\textbackslash}begin\{table\}[!h] command explicitly tells \LaTeX\ where to put the table, overriding a default choice.
